# üåê –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ API

**–ë–∞–∑–æ–≤—ã–π URL**: `http://localhost:8000`

---

## üì∏ Analyze Artifact (–ê–Ω–∞–ª–∏–∑ –ê—Ä—Ç–µ—Ñ–∞–∫—Ç–∞)

–ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏ –ø–æ–ª—É—á–∏—Ç–µ –ø–æ–ª–Ω—ã–π –æ—Ç—á–µ—Ç –æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏, –≤–∫–ª—é—á–∞—è –ø–æ–∫–∞–∑–∞–Ω–∏—è –¥–∞—Ç—á–∏–∫–æ–≤, –æ—Ü–µ–Ω–∫—É –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π –ò–ò –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ä–µ—Å—Ç–∞–≤—Ä–∞—Ü–∏–∏.

- **Endpoint**: `POST /api/analyze`
- **Content-Type**: `multipart/form-data`

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ó–∞–ø—Ä–æ—Å–∞

| –ü–∞—Ä–∞–º–µ—Ç—Ä       | –¢–∏–ø      | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ                                                                    |
| :------------- | :------- | :---------- | :----------- | :-------------------------------------------------------------------------- |
| `file`         | File     | **–î–∞**      | -            | –§–∞–π–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–∞ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ (JPEG, PNG).                         |
| `use_emulator` | String   | –ù–µ—Ç         | "on"         | –ï—Å–ª–∏ "on", –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å–∏–º—É–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–∞—Ç—á–∏–∫–æ–≤. –ò–Ω–∞—á–µ —á–∏—Ç–∞—é—Ç—Å—è —Å Arduino.|
| `lang`         | String   | –ù–µ—Ç         | "ru"         | –Ø–∑—ã–∫ –¥–ª—è –æ—Ç—á–µ—Ç–∞ –ò–ò ("ru" –∏–ª–∏ "en").                                         |

### –ü—Ä–∏–º–µ—Ä –û—Ç–≤–µ—Ç–∞ (JSON)

```json
{
  "sensors": {
    "temperature": 23.38,
    "humidity": 43.98,
    "light": 775.95,
    "environment_status": "WARNING",
    "source": "emulator"
  },
  "vision": {
    "image_class_raw": "crack",
    "image_class": "–¢—Ä–µ—â–∏–Ω–∞",
    "confidence": 0.92,
    "probabilities": {
      "normal": 0.05,
      "crack": 0.92,
      "corrosion": 0.03
    }
  },
  "decision": {
    "risk_level": "HIGH",
    "recommendation": "–¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–∞—è –∏–∑–æ–ª—è—Ü–∏—è –∏–∑-–∑–∞ –≤—ã—Å–æ–∫–æ–π –≤–ª–∞–∂–Ω–æ—Å—Ç–∏ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã—Ö –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π."
  },
  "ai_report": "–ê—Ä—Ç–µ—Ñ–∞–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ—â–∏–Ω—ã, —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–µ —Å..."
}
```

### –û–ø–∏—Å–∞–Ω–∏–µ –ø–æ–ª–µ–π –æ—Ç–≤–µ—Ç–∞

**–û–±—ä–µ–∫—Ç `sensors`:**
| –ü–æ–ª–µ                  | –¢–∏–ø    | –û–ø–∏—Å–∞–Ω–∏–µ                                                          |
| :-------------------- | :----- | :---------------------------------------------------------------- |
| `temperature`         | Number | –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –æ–∫—Ä—É–∂–∞—é—â–µ–π —Å—Ä–µ–¥—ã –≤ –≥—Ä–∞–¥—É—Å–∞—Ö –¶–µ–ª—å—Å–∏—è (–æ–∫—Ä—É–≥–ª–µ–Ω–æ –¥–æ 2 –∑–Ω–∞–∫–æ–≤) |
| `humidity`            | Number | –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–∞—è –≤–ª–∞–∂–Ω–æ—Å—Ç—å –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö (–æ–∫—Ä—É–≥–ª–µ–Ω–æ –¥–æ 2 –∑–Ω–∞–∫–æ–≤)       |
| `light`               | Number | –£—Ä–æ–≤–µ–Ω—å –æ—Å–≤–µ—â–µ–Ω–Ω–æ—Å—Ç–∏ –≤ –ª—é–º–µ–Ω–∞—Ö (–æ–∫—Ä—É–≥–ª–µ–Ω–æ –¥–æ 2 –∑–Ω–∞–∫–æ–≤)            |
| `environment_status`  | String | –°—Ç–∞—Ç—É—Å —Å—Ä–µ–¥—ã: "NORMAL", "WARNING", "DANGER"                       |
| `source`              | String | –ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö: "emulator" –∏–ª–∏ "arduino"                         |

**–û–±—ä–µ–∫—Ç `vision`:**
| –ü–æ–ª–µ              | –¢–∏–ø    | –û–ø–∏—Å–∞–Ω–∏–µ                                                |
| :---------------- | :----- | :------------------------------------------------------ |
| `image_class_raw` | String | –ù–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π –∫–ª–∞—Å—Å –∏–∑ –º–æ–¥–µ–ª–∏ (–Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º)          |
| `image_class`     | String | –ü–µ—Ä–µ–≤–µ–¥–µ–Ω–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–ª–∞—Å—Å–∞                            |
| `confidence`      | Number | –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ –≤ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–∏ (0.0 - 1.0)          |
| `probabilities`   | Object | –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π              |

**–û–±—ä–µ–∫—Ç `decision`:**
| –ü–æ–ª–µ              | –¢–∏–ø    | –û–ø–∏—Å–∞–Ω–∏–µ                                                |
| :---------------- | :----- | :------------------------------------------------------ |
| `risk_level`      | String | –£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞: "LOW", "MEDIUM", "HIGH"                  |
| `recommendation`  | String | –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –ø–æ –¥–µ–π—Å—Ç–≤–∏—è–º –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–∞–≤–∏–ª              |

**–ü–æ–ª–µ `ai_report`:**
- –†–∞–∑–≤–µ—Ä–Ω—É—Ç—ã–π —Ç–µ–∫—Å—Ç–æ–≤—ã–π –æ—Ç—á–µ—Ç, —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π OpenAI GPT-4
- –°–æ–¥–µ—Ä–∂–∏—Ç –¥–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–∞
- –í–∫–ª—é—á–∞–µ—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ä–µ—Å—Ç–∞–≤—Ä–∞—Ü–∏–∏ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—é
- –Ø–∑—ã–∫ –æ—Ç—á–µ—Ç–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `lang` –≤ –∑–∞–ø—Ä–æ—Å–µ

### –ö–æ–¥—ã –û—à–∏–±–æ–∫

- **400 Bad Request**: –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –∑–∞–ø—Ä–æ—Å–∞ –∏–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- **422 Validation Error**: –ù–µ–≤–µ—Ä–Ω—ã–π —Ç–∏–ø —Ñ–∞–π–ª–∞ –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- **500 Internal Server Error**: –ü—Ä–æ–±–ª–µ–º—ã —Å API OpenAI –∏–ª–∏ –∑–∞–≥—Ä—É–∑–∫–æ–π –º–æ–¥–µ–ª–∏ TensorFlow
- **503 Service Unavailable**: –°–µ—Ä–≤–∏—Å –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω (–ø—Ä–æ–±–ª–µ–º—ã —Å –¥–∞—Ç—á–∏–∫–∞–º–∏ –∏–ª–∏ –º–æ–¥–µ–ª—å—é)

---

## üìä –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è API

### –ü—Ä–∏–º–µ—Ä 1: cURL –∑–∞–ø—Ä–æ—Å —Å —ç–º—É–ª—è—Ç–æ—Ä–æ–º

```bash
curl -X POST "http://localhost:8000/api/analyze" \
  -F "file=@/path/to/artifact.jpg" \
  -F "use_emulator=on" \
  -F "lang=ru"
```

### –ü—Ä–∏–º–µ—Ä 2: cURL –∑–∞–ø—Ä–æ—Å —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞—Ç—á–∏–∫–∞–º–∏

```bash
curl -X POST "http://localhost:8000/api/analyze" \
  -F "file=@/path/to/artifact.jpg" \
  -F "lang=en"
```

### –ü—Ä–∏–º–µ—Ä 3: Python requests

```python
import requests

url = "http://localhost:8000/api/analyze"

with open("artifact.jpg", "rb") as f:
    files = {"file": f}
    data = {
        "use_emulator": "on",
        "lang": "ru"
    }
    response = requests.post(url, files=files, data=data)

if response.status_code == 200:
    result = response.json()
    print(f"Temperature: {result['sensors']['temperature']}¬∞C")
    print(f"Risk Level: {result['decision']['risk_level']}")
    print(f"Classification: {result['vision']['image_class']}")
else:
    print(f"Error: {response.status_code}")
```

### –ü—Ä–∏–º–µ—Ä 4: JavaScript Fetch API

```javascript
const formData = new FormData();
formData.append('file', fileInput.files[0]);
formData.append('use_emulator', 'on');
formData.append('lang', 'ru');

fetch('http://localhost:8000/api/analyze', {
  method: 'POST',
  body: formData
})
  .then(response => response.json())
  .then(data => {
    console.log('Temperature:', data.sensors.temperature + '¬∞C');
    console.log('Risk Level:', data.decision.risk_level);
    console.log('AI Report:', data.ai_report);
  })
  .catch(error => console.error('Error:', error));
```

---

## üîç –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∏—Å–µ–ª

–ù–∞—á–∏–Ω–∞—è —Å –≤–µ—Ä—Å–∏–∏ **v2.0.4**, –≤—Å–µ —á–∏—Å–ª–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å–µ–Ω—Å–æ—Ä–æ–≤ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è —Å –æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ–º –¥–æ **2 –∑–Ω–∞–∫–æ–≤ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π** –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏ –≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ:

- `23.377163589653897` ‚Üí `23.38`
- `43.97781669670384` ‚Üí `43.98`
- `775.9468457831356` ‚Üí `775.95`

*–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:* Backend API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ–ª–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è. –û–∫—Ä—É–≥–ª–µ–Ω–∏–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ —É—Ä–æ–≤–Ω–µ frontend –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è.

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

- **JPEG** (.jpg, .jpeg)
- **PNG** (.png)
- **WEBP** (.webp)

–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Ä–∞–∑–º–µ—Ä: –Ω–µ –±–æ–ª–µ–µ 10MB.

### –ö–ª–∞—Å—Å—ã –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π

–ú–æ–¥–µ–ª—å –æ–±—É—á–µ–Ω–∞ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ —Ç–∏–ø—ã –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π:
- **Normal** (–ù–æ—Ä–º–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ) ‚Äî –∞—Ä—Ç–µ—Ñ–∞–∫—Ç –≤ —Ö–æ—Ä–æ—à–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏
- **Crack** (–¢—Ä–µ—â–∏–Ω–∞) ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏—è, —Ç—Ä–µ—â–∏–Ω—ã
- **Corrosion** (–ö–æ—Ä—Ä–æ–∑–∏—è) ‚Äî –æ–∫–∏—Å–ª–µ–Ω–∏–µ, —Ä–∂–∞–≤—á–∏–Ω–∞, –∫–æ—Ä—Ä–æ–∑–∏—è –º–∞—Ç–µ—Ä–∏–∞–ª–∞
- **Dirt** (–ó–∞–≥—Ä—è–∑–Ω–µ–Ω–∏–µ) ‚Äî –ø—ã–ª—å, –≥—Ä—è–∑—å, –Ω–∞–ª–µ—Ç

### –£—Ä–æ–≤–Ω–∏ —Ä–∏—Å–∫–∞

–°–∏—Å—Ç–µ–º–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —É—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏:
1. –¢–∏–ø–∞ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏—è –∏–∑ –º–æ–¥–µ–ª–∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–≥–æ –∑—Ä–µ–Ω–∏—è
2. –£—Å–ª–æ–≤–∏–π –æ–∫—Ä—É–∂–∞—é—â–µ–π —Å—Ä–µ–¥—ã (—Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞, –≤–ª–∞–∂–Ω–æ—Å—Ç—å, –æ—Å–≤–µ—â–µ–Ω–Ω–æ—Å—Ç—å)
3. –ü—Ä–µ–¥–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª –≤ `backend/core/decision_engine.py`

**–£—Ä–æ–≤–Ω–∏:**
- **LOW** ‚Äî –∞—Ä—Ç–µ—Ñ–∞–∫—Ç –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, —Ç—Ä–µ–±—É–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ
- **MEDIUM** ‚Äî —Ç—Ä–µ–±—É–µ—Ç—Å—è –≤–Ω–∏–º–∞–Ω–∏–µ, –≤–æ–∑–º–æ–∂–Ω–∞ –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∞
- **HIGH** ‚Äî –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã —Å—Ä–æ—á–Ω—ã–µ –º–µ—Ä—ã

---

## üõ†Ô∏è –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### Swagger UI

FastAPI –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é:

**OpenAPI (Swagger) UI:** http://localhost:8000/docs
**ReDoc:** http://localhost:8000/redoc

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Swagger UI –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è API –≤ –±—Ä–∞—É–∑–µ—Ä–µ –±–µ–∑ –Ω–∞–ø–∏—Å–∞–Ω–∏—è –∫–æ–¥–∞.

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–µ—Ä–≤–∏—Å–∞

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ API
curl http://localhost:8000/

# –û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç: –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤–µ—Ä—Å–∏–∏ –∏ —Å—Ç–∞—Ç—É—Å–µ
```

---

## üìö –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã](ARCHITECTURE.md)
- [–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ](SETUP.md)
- [–°—Ü–µ–Ω–∞—Ä–∏–π –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏](DEMO_SCENARIO.md)
